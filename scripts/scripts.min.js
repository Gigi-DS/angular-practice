var blogApp=angular.module("someBlogApp",["ngRoute","someBlogServices","ngAnimate"]);blogApp.controller("testCtrl",["$scope","$http",function(e,t){e.main={Name:"Gigi",Address:"Unknown"}}]),blogApp.config(["$routeProvider",function(e){e.when("/",{templateUrl:"app/views/home.html",controller:"homeCtrl"}).when("/articles",{templateUrl:"app/views/articles.html",controller:"articlesCtrl"}).when("/article/:articleId",{templateUrl:"app/views/article.html",controller:"articleCtrl"}).when("/register",{templateUrl:"app/views/register.html",controller:"registerCtrl"}).when("/addarticle",{templateUrl:"app/views/addarticle.html",controller:"addArticleCtrl"}).when("/persons",{templateUrl:"app/views/persons.html",controller:"personsCtrl"}).when("/addcustomer",{templateUrl:"app/views/addcustomer.html",controller:"addCustCtrl"}).when("/editcustomer/:customerId",{templateUrl:"app/views/editcustomer.html",controller:"editCustCtrl"}).when("/partialupdate",{templateUrl:"app/views/partialupdate.html",controller:"partialUpdtCtrl"}).otherwise({redirectTo:"app/"})}]),blogApp.directive("someBlogArticles",function(){return{restrict:"A",templateUrl:"app/views/directivetmpl/articles.html"}}).directive("someBlogFullArticle",function(){return{restrict:"E",templateUrl:"app/views/directivetmpl/fullarticle.html"}}).directive("emailRequiredValid",function(){return{link:function(e,t,r){t.on("blur",function(){e.regform.email.$error.required&&alert("field is required"),e.regform.email.$invalid&&!e.regform.email.$error.required&&alert("invalid email")})}}}).directive("nameRequired",function(){return{link:function(e,t,r){t.on("blur",function(){e.regform.name.$error.required&&alert("field is required"),e.regform.$error.minlength&&alert("You must enter min. 3 characters")})}}}).directive("passRequired",function(){return{restrict:"A",link:function(e,t,r){t.on("blur",function(){e.regform.password.$error.required&&alert("this field is required"),e.regform.password.$error.minlength&&alert("You must enter min. 6 characters")})}}}).directive("pwCheck",[function(){return{require:"ngModel",link:function(e,t,r){var o="#"+r.pwCheck;t.on("blur",function(){t.val()!==$(o).val()&&alert("Passwords doesn`t match!")})}}}]);var articleServices=angular.module("someBlogServices",["ngResource"]);articleServices.factory("articles",["$resource",function(e){return e("jsondata/:articleId.json",{},{query:{method:"GET",params:{articleId:"articles"},isArray:!0}})}]),articleServices.factory("LS",["$window",function(e){function t(){if(!e.localStorage)throw new Error("local Storage is not set")}return t(),{setData:function(t,r){e.localStorage.setItem(r,JSON.stringify(t))},getData:function(t){return JSON.parse(e.localStorage.getItem(t))},clearData:function(t){e.localStorage.removeItem(t)}}}]),articleServices.factory("artID",["$window",function(e){return{setId:function(){return Math.floor(6e3*Math.random()+1)}}}]),articleServices.factory("customerData",["$http","LS","$q","$filter","$log",function(e,t,r,o,a){function n(e,t){for(var r=0;r<e.length&&e[r].id!=t;r++);return e[r]}function i(){return customers=t.getData("cutomers"),s=customers?r.resolve(customers):e.get(c).then(function(e){return t.setData(e.data,"cutomers"),e.data})["catch"](function(e){throw{status:e.staus,message:e.statusText}}),s["catch"](l),s}function l(e){a.error(e),a.error({status:e.status,message:e.message,source:"customerData"})}var c="jsondata/articles1.json",s=null;return schema={type:"object",properties:{id:{type:"number"},name:{type:"string"},lastname:{type:"string"},hobby:{type:"string"},age:{type:"string"}}},i(),{getData:function(e,t,r,a,n){return s.then(function(i){function l(e){for(var t=[],r=0;r<i.length;r++)(i[r].id==e||i[r].name.toLowerCase()==e.toLowerCase()||i[r].lastname.toLowerCase()==e.toLowerCase()||i[r].hobby.toLowerCase()==e.toLowerCase())&&t.push(i[r]);return t}pages=Math.ceil(i.length/n),e&&(i=l(e));var c=i.length;return t&&(t=r?"+"+t:"-"+t,i=o("orderBy")(i,t)),beginWith=(a-1)*n,i=o("limitTo")(i,n,beginWith),{items:i,count:c}})},getCount:function(){return s.then(function(e){return e.length})},removeItem:function(e){return s.then(function(r){var o,a=r.some(function(t,r){return o=r,t.id==e});return a?(r.splice(o,1),console.log(r),t.setData(r,"cutomers"),!0):!1})},addCustomer:function(e){var r=tv4.validateMultiple(e,schema);return r.valid?s.then(function(r){return r.lastId=0,id=0,angular.forEach(r,function(e,t){e.id>id&&(id=e.id)}),id+=1,e.id=id,r.push(e),t.setData(r,"cutomers"),angular.copy(e)}):r},getAll:function(){return s.then(function(e){return angular.copy(e)})},updateCustomer:function(e){return s.then(function(o){var a=tv4.validateMultiple(e,schema);return a.valid?(arr=[],angular.forEach(o,function(t,r){t.id!=e.id&&arr.push(t)}),arr.push(e),o=arr,t.setData(o,"cutomers"),s=r.resolve(o),angular.copy(arr)):a})},getCustomer:function(e){return s.then(function(t){return customer={},customer=n(t,e),angular.copy(customer)})},customerPatch:function(e){return s.then(function(r){var o=tv4.validateMultiple(e,schema);return o.valid?(angular.merge(n(r,e.id),e),console.log(r),t.setData(r,"cutomers"),e):o})}}}]),blogApp.controller("addArticleCtrl",["$scope","$http","articles","LS","artID",function(e,t,r,o,a){e.article={id:"",img:"",title:"",short_desc:"",desc:""},e.addArticle=function(t){e.articles=o.getData(),console.log("old articles"+e.articles),e.id=a.setId(),(e.articles.id=e.id)&&(e.id=a.setId()),e.article.id=e.id,e.article.img="3.jpg",e.articles=e.articles.push(t),console.log("new articles"+e.articles),console.log(e.article),o.setData(e.articles)}}]),blogApp.controller("addCustCtrl",["$scope","$log","LS","$window","customerData",function(e,t,r,o,a){e.cust={id:0,name:"",lastname:"",hobby:"",age:""},e.addCust=function(t){a.addCustomer(t).then(function(t){t.valid===!1?alert("Adding new customer error, please check data type"):(e.cust=t,o.alert("Customer Successeful added!"))})},e.redirect=function(){o.location="#/persons"}}]),blogApp.controller("alertCtrl",["$scope","$timeout",function(e,t){e.message=!0,t(function(){e.message=!1},3e3)}]),blogApp.controller("articleCtrl",["$scope","$http","$routeParams","articles",function(e,t,r,o){e.article=o.get({articleId:r.articleId})}]),blogApp.controller("articlesCtrl",["$scope","$window","$http","articles","LS",function(e,t,r,o,a){e.orderArticle="-id",e.articles=a.getData("articles-storage"),console.log(e.articles),e.removeArticle=function(t){for(i=e.articles.length-1;i>=0;i--)e.articles[i].id==t&&e.articles.splice(i,1),a.setData(e.articles)}}]),blogApp.controller("editCustCtrl",["$scope","$window","$routeParams","$log","$location","customerData",function(e,t,r,o,a,n){function i(){n.getCustomer(e.customerId).then(function(t){e.customer=t})}e.customerId=r.customerId,e.customer={},i(),e.updateCustomer=function(e){n.updateCustomer(e).then(function(e){e.valid===!1?t.alert("Error on updating cunstomer, please check type of variables"):(t.alert("Customer Succesefully Updated"),a.path("/persons"))})},e.removeData=function(e){confirm("Sure to DELETE?")&&n.removeItem(e).then(function(e){a.path("/persons")})},e.redirect=function(e,t){confirm("sure cancel editing?")&&a.path("/persons")}}]),blogApp.controller("homeCtrl",["$scope","$http","articles",function(e,t,r){e.articles=r.query()}]),blogApp.controller("partialUpdtCtrl",["$scope","customerData",function(e,t){}]),blogApp.controller("personsCtrl",["$scope","$routeParams","$window","customerData","$log","$location","$filter","$http",function(e,t,r,o,a,n,l,c){function s(){u()}function u(){o.getData(e.search,e.sortKey,e.reverse,e.pageIndex,e.pageSize).then(function(t){for(items=t.items,i=0;i<items.length;i++)items[i]=d(items[i]);e.persons=t.items,e.totalPages=Math.ceil(t.count/e.pageSize),e.totalPagesArr=m(e.totalPages)})["catch"](function(e){r.alert(e.message)})}function d(e){var t={},r=new Date(e.age);t.birthday=angular.copy(e.age);var o=new Date(l("date")(new Date,"yyyy/MM/dd")),a=o-r,n=6e4,i=60*n,c=24*i,s=365*c;return t.birthday=Math.round(a/s),angular.merge({},e,t)}function p(t){null==e.maxPageRightLeft&&(e.maxPageRightLeft=2);var r=[];for(i=1;i<=e.maxPageRightLeft;i++){var o=e.pageIndex-i,a=e.pageIndex+i;o>0&&r.push(o),a<=e.totalPages&&r.push(a)}return r.push(e.pageIndex),r.sort()}function m(e){var t=[];for(i=1;i<=e;i++)t.push(i);return p(t),p(t)}e.persons=[],e.search="",e.sortKey="id",e.reverse=!0,e.pageIndex=1,e.pageSize=5,e.maxPageRightLeft=2,e.totalPages=0,e.removeId=!1,e.refresh=u,e.quickEdit=!1,s(),e.reloadPage=function(){r.location.reload()},e.sort=function(t){e.sortKey!=t?(e.sortKey=t,e.reverse=!1):e.reverse=!e.reverse,u()},e.setPage=function(t){e.pageIndex=t,u()},e.showCustomer=function(t){e.quickEdit=!0;for(var r={},o=0;o<e.persons.length;o++)if(e.persons[o].id==t){r=angular.copy(e.persons[o]);break}return e.customer=r},e.close=function(){e.customer={},e.quickEdit=!1},e.quickSave=function(t){o.customerPatch(t).then(function(t){t.valid===!1?alert("Error on partial udpdate, please check data type!"):(e.quickEdit=!1,e.customer={},u())})},e.redirect=function(e,t){r.location=e+t},a.error()}]),blogApp.controller("registerCtrl",["$scope","$http",function(e,t){e.user={}}]);
//# sourceMappingURL=scripts.min.js.map