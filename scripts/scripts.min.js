var blogApp=angular.module("someBlogApp",["ngRoute","someBlogServices","angularUtils.directives.dirPagination"]);blogApp.controller("testCtrl",["$scope","$http",function(e,t){e.main={Name:"Gigi",Address:"Unknown"}}]),blogApp.config(["$routeProvider",function(e){e.when("/",{templateUrl:"app/views/home.html",controller:"homeCtrl"}).when("/articles",{templateUrl:"app/views/articles.html",controller:"articlesCtrl"}).when("/article/:articleId",{templateUrl:"app/views/article.html",controller:"articleCtrl"}).when("/register",{templateUrl:"app/views/register.html",controller:"registerCtrl"}).when("/addarticle",{templateUrl:"app/views/addarticle.html",controller:"addArticleCtrl"}).when("/persons",{templateUrl:"app/views/persons.html",controller:"personsCtrl"}).when("/addcustomer",{templateUrl:"app/views/addcustomer.html",controller:"addCustCtrl"}).when("/editcustomer/:customerId",{templateUrl:"app/views/editcustomer.html",controller:"editCustCtrl"}).otherwise({redirectTo:"app/"})}]),blogApp.controller("addArticleCtrl",["$scope","$http","articles","LS","artID",function(e,t,r,o,n){e.article={id:"",img:"",title:"",short_desc:"",desc:""},e.addArticle=function(t){e.articles=o.getData(),console.log("old articles"+e.articles),e.id=n.setId(),(e.articles.id=e.id)&&(e.id=n.setId()),e.article.id=e.id,e.article.img="3.jpg",e.articles=e.articles.push(t),console.log("new articles"+e.articles),console.log(e.article),o.setData(e.articles)}}]),blogApp.controller("addCustCtrl",["$scope","$log","LS","$window","customerData",function(e,t,r,o,n){e.cust={id:0,name:"",lastname:"",hobby:"",age:""},e.addCust=function(t){n.addCustomer(t).then(function(t){e.cust=t,o.alert("Customer Successeful added!")})}}]),blogApp.controller("articleCtrl",["$scope","$http","$routeParams","articles",function(e,t,r,o){e.article=o.get({articleId:r.articleId})}]),blogApp.controller("articlesCtrl",["$scope","$window","$http","articles","LS",function(e,t,r,o,n){e.orderArticle="-id",e.articles=n.getData("articles-storage"),console.log(e.articles),e.removeArticle=function(t){for(i=e.articles.length-1;i>=0;i--)e.articles[i].id==t&&e.articles.splice(i,1),n.setData(e.articles)}}]),blogApp.controller("editCustCtrl",["$scope","$window","$routeParams","$log","$location","customerData",function(e,t,r,o,n,a){function i(){a.getCustomer(e.customerId).then(function(t){e.customer=t})}e.customerId=r.customerId,e.customer={},i(),e.updateCustomer=function(e){a.updateCustomer(e).then(function(e){e&&(t.alert("Customer Succesefully Updated"),n.path("/persons"))})}}]),blogApp.controller("homeCtrl",["$scope","$http","articles",function(e,t,r){e.articles=r.query()}]),blogApp.controller("personsCtrl",["$scope","$routeParams","$window","customerData","$log",function(e,t,r,o,n){function a(){l()}function l(){o.getData(e.search,e.sortKey,e.sortReverse,e.pageIndex,e.pageSize).then(function(t){e.persons=t.items,e.totalPages=Math.ceil(t.count/e.pageSize),e.totalPages=c(e.totalPages)})}function c(e){var t=[];for(i=1;i<=e;i++)t.push(i);return t}e.persons=[],e.search="",e.sortKey="id",e.sortReverse=!0,e.pageIndex=1,e.pageSize=5,e.totalPages=0,e.removeId=!1,e.refresh=l,a(),e.sort=function(t){e.sortKey!=t?(e.sortKey=t,e.sortReverse=!1):e.sortReverse=!e.sortReverse,l()},e.setPage=function(t){e.pageIndex=t,l()},e.removeData=function(e){confirm("Sure to DELETE?")&&(o.removeItem(e),l())}}]),blogApp.controller("registerCtrl",["$scope","$http",function(e,t){e.user={}}]),blogApp.directive("someBlogArticles",function(){return{restrict:"A",templateUrl:"app/views/directivetmpl/articles.html"}}).directive("someBlogFullArticle",function(){return{restrict:"E",templateUrl:"app/views/directivetmpl/fullarticle.html"}}).directive("emailRequiredValid",function(){return{link:function(e,t,r){t.on("blur",function(){e.regform.email.$error.required&&alert("field is required"),e.regform.email.$invalid&&!e.regform.email.$error.required&&alert("invalid email")})}}}).directive("nameRequired",function(){return{link:function(e,t,r){t.on("blur",function(){e.regform.name.$error.required&&alert("field is required"),e.regform.$error.minlength&&alert("You must enter min. 3 characters")})}}}).directive("passRequired",function(){return{restrict:"A",link:function(e,t,r){t.on("blur",function(){e.regform.password.$error.required&&alert("this field is required"),e.regform.password.$error.minlength&&alert("You must enter min. 6 characters")})}}}).directive("pwCheck",[function(){return{require:"ngModel",link:function(e,t,r){var o="#"+r.pwCheck;t.on("blur",function(){t.val()!==$(o).val()&&alert("Passwords doesn`t match!")})}}}]);var articleServices=angular.module("someBlogServices",["ngResource"]);articleServices.factory("articles",["$resource",function(e){return e("jsondata/:articleId.json",{},{query:{method:"GET",params:{articleId:"articles"},isArray:!0}})}]),articleServices.factory("LS",["$window",function(e){function t(){if(!e.localStorage)throw new Error("local Storage is not set")}return t(),{setData:function(t,r){e.localStorage.setItem(r,JSON.stringify(t))},getData:function(t){return JSON.parse(e.localStorage.getItem(t))},clearData:function(t){e.localStorage.removeItem(t)}}}]),articleServices.factory("artID",["$window",function(e){return{setId:function(){return Math.floor(6e3*Math.random()+1)}}}]),articleServices.factory("customerData",["$http","LS","$q","$filter",function(e,t,r,o){function n(){return customers=t.getData("cutomers"),i=customers?r.resolve(customers):e.get(a).then(function(e){return t.setData(e.data,"cutomers"),e.data})}var a="jsondata/articles1.json",i=null;return n(),{getData:function(e,t,r,n,a){return i.then(function(i){function l(){var t=o("filter")(i,{name:e}),r=o("filter")(i,{lastname:e}),n=o("filter")(i,{hobby:e}),a=o("filter")(i,{id:e}),l=t.concat(r).concat(n).concat(a),c=l.filter(function(e,t){return l.indexOf(e)==t});return c}pages=Math.ceil(i.length/a),e&&(i=l());var c=i.length;return t&&(t=r?"+"+t:"-"+t,i=o("orderBy")(i,t)),beginWith=(n-1)*a,i=o("limitTo")(i,a,beginWith),{items:i,count:c}})},getCount:function(){return i.then(function(e){return e.length})},removeItem:function(e){return i.then(function(r){return console.log("data-load value "+i.$$state.value),e&&(customerArr=[],angular.forEach(r,function(t,r){t.id!==e&&customerArr.push(t)}),r=customerArr,console.log("after removing \n"+r),t.clearData("cutomers"),test1=t.getData("cutomers"),console.log("data after LS delete Item \n"+test1),t.setData(customerArr,"cutomers"),i.$$state.value=customerArr,test=t.getData("cutomers"),console.log("data from LS after remove \n"+test)),r})},addCustomer:function(e){return i.then(function(r){return id=0,angular.forEach(r,function(e,t){e.id>id&&(id=e.id)}),id+=1,e.id=id,r.push(e),t.clearData("cutomers"),t.setData(r,"cutomers"),i.$$state.value=r,cust={id:0,name:"",lastname:"",hobby:"",age:""}})},getCustomer:function(e){return i.then(function(t){return customer=[],angular.forEach(t,function(t,r){t.id==e&&(customer=t)}),customer})},updateCustomer:function(e){return i.then(function(r){return arr=[],angular.forEach(r,function(t,r){t.id!=e.id&&arr.push(t)}),arr.push(e),r=arr,t.clearData("cutomers"),t.setData(r,"cutomers"),i.$$state.value=r,!0})}}}]);
//# sourceMappingURL=scripts.min.js.map